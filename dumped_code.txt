// index.html
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKU - Analisis Kelayakan Usaha</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <header>
        AKU - Analisis Kelayakan Usaha
    </header>

    <div class="container">
        <h2 class="bold">Input Data</h2>

        <div class="form-group">
            <label>Investment Cost 
                <button class="info-btn" data-info="Investment Cost adalah biaya awal yang diperlukan untuk memulai usaha.">ⓘ</button>
            </label>
            <div class="input-with-button">
                <input type="number" id="investment" readonly>
                <button class="btn-tambah" onclick="openTablePopup('investment')">Tambahkan</button>
            </div>
        </div>
        
        <div class="form-group">
            <label>Operational Cost 
                <button class="info-btn" data-info="Operational Cost adalah biaya yang harus dikeluarkan setiap bulan untuk menjalankan usaha.">ⓘ</button>
            </label>
            <div class="input-with-button">
                <input type="number" id="operational" readonly>
                <button class="btn-tambah" onclick="openTablePopup('operational')">Tambahkan</button>
            </div>
        </div>        

        <div class="form-group">
            <label>Harga Jual per Unit 
                <button class="info-btn" data-info="Harga jual per unit adalah harga yang ditetapkan untuk satu produk.">ⓘ</button>
            </label>
            <input type="number" id="price">
        </div>

        <div class="form-group">
            <label>Biaya Produksi per Unit 
                <button class="info-btn" data-info="Biaya produksi per unit adalah biaya yang dikeluarkan untuk membuat satu unit produk.">ⓘ</button>
            </label>
            <input type="number" id="cost">
        </div>

        <div class="form-group">
            <label>Volume Penjualan per Bulan 
                <button class="info-btn" data-info="Volume penjualan per bulan adalah jumlah produk yang dijual setiap bulan.">ⓘ</button>
            </label>
            <input type="number" id="volume">
        </div>

        <button onclick="hitungAnalisis()" class="btn-hitung">Hitung</button>

        <h2 class="hasil-analisis">Hasil Analisis</h2>
        <button onclick="toggleFormatBep()" class="btn-toggle">Ubah Format BEP</button>
        <table>
            <tr><td>ROI (Return on Investment)</td><td id="roi">-</td></tr>
            <tr><td>BEP (Break Even Point)</td><td id="bep">-</td></tr>
            <tr><td>HPP (Harga Pokok Produksi)</td><td id="hpp">-</td></tr>
            <tr><td>Payback Period</td><td id="pp">-</td></tr>
        </table>
    </div>

    <!-- Pop-up -->
    <div id="popup">
        <div id="popup-content">
            <span id="close-popup"><i class="fas fa-times"></i></span>
            <p id="popup-text"></p>
        </div>
    </div>

    <!-- Pop-up Info -->
    <div id="popupInfo" class="hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
        <div class="bg-white p-4 rounded-lg shadow-lg relative">
            <button id="closePopup" class="absolute top-2 right-2 text-gray-500 hover:text-red-500">
                <i class="fas fa-xmark"></i> <!-- Ikon "X" -->
            </button>
            <p id="popupText">Isi informasi di sini...</p>
        </div>
    </div>

    <!-- Pop-up Investment Cost -->
    <div id="investmentPopup" class="popup">
        <div class="popup-content">
            <span class="close" onclick="closeTablePopup('investmentPopup')">&times;</span>
            <h2 class="bold">Investment Cost</h2>
            <button class="btn-tambah" onclick="addRow('investmentTable')">Tambah Baris</button>
            <table id="investmentTable">
                <thead>
                    <tr>
                        <th>Nama</th>
                        <th>Kuantitas</th>
                        <th>Harga</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- Pop-up Operational Cost -->
    <div id="operationalPopup" class="popup">
        <div class="popup-content">
            <span class="close" onclick="closeTablePopup('operationalPopup')">&times;</span>
            <h2 class="bold">Operational Cost</h2>
            <button class="btn-tambah" onclick="addRow('operationalTable')">Tambah Baris</button>
            <table id="operationalTable">
                <thead>
                    <tr>
                        <th>Nama</th>
                        <th>Kuantitas</th>
                        <th>Harga</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>


    <!-- Footer -->
    <footer class="text-center mt-5 text-gray-700">
        <p>Created by adsurkasur (with AI)</p>
        <div class="footer-icons flex justify-center mt-2 space-x-3">
            <a href="https://twitter.com/adsurkasur" target="_blank">
                <i class="fab fa-x-twitter"></i> <!-- Ikon Twitter sesuai referensi -->
            </a>
            <a href="https://github.com/adsurkasur" target="_blank">
                <i class="fab fa-github"></i> <!-- Ikon GitHub -->
            </a>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>

// script.js
// Variabel global untuk menyimpan format BEP (default: unit)
let isBepRupiah = false;

// Fungsi toggle format BEP (unit <-> rupiah)
function toggleFormatBep() {
    isBepRupiah = !isBepRupiah;
    hitungAnalisis();
}

// Fungsi utama untuk perhitungan
function hitungAnalisis() {
    let investment = getValue("investment");
    let operational = getValue("operational");
    let price = getValue("price");
    let cost = getValue("cost");
    let volume = getValue("volume");

    let profit = (price - cost) * volume - operational;
    let roi = investment > 0 ? (profit / investment * 100).toFixed(2) + "%" : "Tidak valid";
    let bepUnit = price > cost ? (investment / (price - cost)).toFixed(2) : "Tidak valid";
    let bepRupiah = price > cost ? formatRupiah((investment / (price - cost)) * price) : "Tidak valid";
    let hpp = volume > 0 ? formatRupiah((cost * volume + operational) / volume) : "Tidak valid";
    let pp = profit > 0 ? (investment / profit).toFixed(2) + " bulan" : "Tidak valid";

    setText("bep", isBepRupiah ? bepRupiah : `${bepUnit} unit`);
    setText("hpp", hpp);
    setText("roi", roi);
    setText("pp", pp);
}

// Fungsi untuk format Rupiah
function formatRupiah(number) {
    return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR' }).format(number);
}

// Fungsi mendapatkan nilai input dengan ID tertentu (dengan pengecekan agar tidak error)
function getValue(id) {
    let el = document.getElementById(id);
    return el ? parseFloat(el.value) || 0 : 0;
}

// Fungsi mengubah teks dalam elemen dengan ID tertentu
function setText(id, text) {
    let el = document.getElementById(id);
    if (el) el.textContent = text;
}

// Fungsi untuk update perhitungan berdasarkan data tabel
function updateCalculations() {
    let totalUnit = getValue("totalUnit");
    let biayaProduksi = getValue("biayaProduksi");
    let hppValue = totalUnit > 0 ? biayaProduksi / totalUnit : 0;

    setText("hpp", totalUnit > 0 ? formatRupiah(hppValue) : "Tidak valid");
    setText("bep", hppValue > 0 ? (getValue("investment") / hppValue).toFixed(2) : "Tidak valid");
}

// Fungsi untuk tabel (tambah/hapus/update total)
function addRow(tableId) {
    let table = document.querySelector(`#${tableId} tbody`);
    let row = table.insertRow();
    row.innerHTML = `
        <td><input type="text"></td>
        <td><input type="number" oninput="updateTotalCost('${tableId}')"></td>
        <td><input type="number" oninput="updateTotalCost('${tableId}')"></td>
        <td><button class="btn-hapus" onclick="deleteRow(this, '${tableId}')">Hapus</button></td>
    `;
}

function deleteRow(button, tableId) {
    button.parentElement.parentElement.remove();
    updateTotalCost(tableId);
}

function updateTotalCost(tableId) {
    let total = 0;
    document.querySelectorAll(`#${tableId} tbody tr`).forEach(row => {
        let qty = row.cells[1].querySelector("input").value || 0;
        let price = row.cells[2].querySelector("input").value || 0;
        total += (parseFloat(qty) * parseFloat(price));
    });
    document.getElementById(tableId === "investmentTable" ? "investment" : "operational").value = total;
}

// Fungsi untuk membuka/menutup tabel pop-up
function openTablePopup(type) {
    let popup = document.getElementById(type === 'investment' ? "investmentPopup" : "operationalPopup");
    if (popup) {
        popup.style.display = "block";
        document.body.style.overflow = "hidden";
    }
}

function closeTablePopup(type) {
    let popup = document.getElementById(type);
    if (popup) {
        popup.style.display = "none";
        document.body.style.overflow = "auto";
    }
}

// Menutup pop-up jika klik di luar kontennya
document.querySelectorAll(".popup").forEach(popup => {
    popup.addEventListener("click", function(event) {
        if (event.target === this) {
            this.style.display = "none";
            document.body.style.overflow = "auto";
        }
    });
});


// styles.css
/* === 1. GLOBAL STYLES === */
body {
    font-family: 'Rubik', sans-serif;
    background-color: #f3f4f6;
    text-align: center;
}

header {
    background-color: #2563eb;
    color: white;
    font-size: 1.25rem;
    font-weight: bold;
    padding: 10px;
}

/* === 2. CONTAINER & STRUCTURE === */
.container {
    max-width: 500px;
    margin: auto;
    background: #f9f9f9;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.1);
}

h2 {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 15px;
}

.hasil-analisis {
    font-weight: bold;
    margin-top: 30px; /* Memberi jarak dari tombol Hitung */
}

.bold {
    font-weight: bold;
}

/* === 3. FORM STYLES === */
.form-group {
    margin: 10px 0;
    text-align: left;
}

.input-group {
    margin-bottom: 15px;
    text-align: left;
}

.input-with-button {
    display: flex;
    gap: 10px;
}

label {
    font-weight: 500;
}

input {
    width: 100%;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 5px;
    margin-top: 5px;
}

input[readonly] {
    background-color: white;
    color: #4b5563;
    cursor: not-allowed;
}

/* === 4. BUTTON STYLES === */
button {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
}

.btn-tambah {
    background-color: #2563eb;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: bold;
}

.btn-tambah:hover {
    background-color: #1e40af;
}

.btn-hitung {
    width: 100%;
    background-color: #10b981;
    color: white;
    padding: 10px;
    font-size: 1rem;
    font-weight: bold;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 15px;
}

.btn-hapus {
    background-color: #dc2626;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: bold;
}

.btn-hapus:hover {
    background-color: #b91c1c;
}

.info-btn {
    background: none;
    border: none;
    color: #2563eb;
    cursor: pointer;
    font-size: 1rem;
    margin-left: 5px;
}

.btn-toggle {
    background-color: #f59e0b;
    color: white;
    border: none;
    padding: 5px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: bold;
    margin-bottom: 10px;
}

.btn-toggle:hover {
    background-color: #d97706;
}

/* === 5. TABLE STYLES === */
.table-container {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid #ddd;
    border-radius: 5px;
}

table {
    width: 100%;
    margin-top: 10px;
    border-collapse: collapse;
}

#costTable {
    width: 100%;
    border-collapse: collapse;
}

#costTable th, #costTable td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

#costTable thead {
    position: sticky;
    top: 0;
    background-color: white;
    z-index: 1;
}

td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

/* === 6. POPUP STYLES === */
#popup {
    position: fixed;
    inset: 0;
    display: none;
    background: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
}

#popup-content {
    background: white;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    position: relative;
}

.popup {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
}

.popup-content {
    background: white;
    width: 80%;
    padding: 20px;
    margin: 10% auto;
    border-radius: 8px;
}

#popupInfo div {
    position: relative;
    max-width: 400px;
    text-align: center;
}

#popupInfo button {
    font-size: 1.2rem;
}

/* CLOSE BUTTON */
.close {
    float: right;
    font-size: 20px;
    cursor: pointer;
}

#close-popup {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 1.2rem;
}

/* === 7. FOOTER STYLES === */
.footer-icons {
    font-size: 1.5rem;
}

.footer-icons a {
    margin: 0 10px;
    color: inherit;
    text-decoration: none;
}

.footer-icons a:hover {
    opacity: 0.7;
}

footer {
    margin-top: 20px;
    font-size: 0.9rem;
}

footer a {
    margin: 0 10px;
    font-size: 1.5rem;
    color: #333;
    text-decoration: none;
}

footer a:hover {
    color: #2563eb;
    opacity: 0.7;
}

.popup-content {
    background: white;
    width: 80%;
    padding: 20px;
    margin: 10% auto;
    border-radius: 8px;
    max-height: 80vh;
    overflow-y: auto; /* Pop-up bisa di-scroll jika kontennya terlalu panjang */
}

.table-container {
    max-height: 300px; /* Maksimum tinggi tabel */
    overflow-y: auto;  /* Scroll jika lebih dari 300px */
    border: 1px solid #ddd;
    border-radius: 5px;
}

#investmentTable, #operationalTable {
    width: 100%;
    border-collapse: collapse;
}

#investmentTable th, #investmentTable td,
#operationalTable th, #operationalTable td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

#investmentTable thead, #operationalTable thead {
    position: sticky;
    top: 0;
    background-color: white;
    z-index: 1;
}


